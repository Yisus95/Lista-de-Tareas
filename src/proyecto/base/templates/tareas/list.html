{% extends 'base/principal.html' %}
{% block content %}

<div class="barra-superior">
  <div>
    {% if request.user.is_authenticated %}
      <h1>Hola {{ request.user|title }}</h1>
      <h3>Tienes <span class="count">{{ count }}</span> tarea{{ count|pluralize }} incompleta{{ count|pluralize }}</h3>
    {% else %}
      <h1>Bienvenido</h1>
    {% endif %}
  </div>
  {% if request.user.is_authenticated %}
    <form method="post" action="{% url 'logout' %}">
      {% csrf_token %}
      <button type="submit" class="logout-btn">Cerrar sesión</button>
    </form>
  {% else %}
    <a href="{% url 'login' %}">Iniciar sesión</a>
  {% endif %}
</div>

<div id="envoltorio-agregar-buscar">
  <section class="seccion2">
    <form method="GET" action="">
      <input type="text" name="buscar" placeholder="Buscar tarea" value="{{ request.GET.buscar|default:'' }}">
      <input class="boton" type="submit" value="Buscar">
    </form>
    <a id="enlace-agregar" href="{% url 'crear-tarea' %}" aria-label="Añadir tarea">&#xFF0B;</a>
  </section>
</div>

<div class="envoltorio-items-tarea">
  {% for tarea in tareas %}
    <div class="envoltorio-tarea {% if tarea.completo %}completada{% endif %}">
      <span class="titulo-tarea">
        {% if tarea.completo %}
          <div class="icono-tarea-completa" aria-hidden="true"></div>
          <s><a href="{% url 'editar-tarea' tarea.pk %}">{{ tarea.titulo }}</a></s>
        {% else %}
          <div class="icono-tarea-incompleta" aria-hidden="true"></div>
          <a href="{% url 'editar-tarea' tarea.pk %}">{{ tarea.titulo }}</a>
        {% endif %}
      </span>
      <a class="enlace-eliminar" href="{% url 'eliminar-tarea' tarea.pk %}" aria-label="Eliminar tarea">×</a>
    </div>
  {% empty %}
    <h3>No hay tareas pendientes.</h3>
  {% endfor %}
</div>

{% endblock %}