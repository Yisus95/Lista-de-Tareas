{% load static %}
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Lista de Pendientes</title>

    <!-- Google Fonts (solo una vez) -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,100..900;1,100..900&family=Red+Hat+Display:ital,wght@0,300..900;1,300..900&display=swap" rel="stylesheet">

    <!-- Enlace al CSS estático -->
    <link rel="stylesheet" href="{% static 'css/main.css' %}">
</head>
<body>
  <div class="container">

    {# --- Mensajes flash accesibles y manejables --- #}
    {% if messages %}
      <div id="flash-messages" aria-live="polite" aria-atomic="true">
        {% for message in messages %}
          <div class="flash-message {{ message.tags }}" role="status" tabindex="0" data-timeout="4000">
            <span class="flash-content">{{ message }}</span>
            <button type="button" class="flash-close" aria-label="Cerrar mensaje">&times;</button>
          </div>
        {% endfor %}
      </div>

      <noscript>
        <!-- Fallback visible si JS está deshabilitado -->
        <div style="background:#fff;color:#000;padding:8px;margin:10px;border:1px solid #000;">
          {% for message in messages %}
            <div>{{ message }} ({{ message.tags }})</div>
          {% endfor %}
        </div>
      </noscript>

      <script>
        (function () {
          if (typeof window === 'undefined') return;

          function hideFlash(el) {
            if (!el) return;
            el.classList.add('hide');
            el.addEventListener('transitionend', function () {
              try { el.remove(); } catch (e) { /* ignore */ }
            }, { once: true });
          }

          window.addEventListener('load', function () {
            const container = document.getElementById('flash-messages');
            if (!container) return;

            const flashes = container.querySelectorAll('.flash-message');
            flashes.forEach(function (el) {
              el.setAttribute('tabindex', '0');
              const t = parseInt(el.getAttribute('data-timeout'), 10) || 4000;
              const timer = setTimeout(function () { hideFlash(el); }, t);
              const btn = el.querySelector('.flash-close');
              if (btn) {
                btn.addEventListener('click', function () {
                  clearTimeout(timer);
                  hideFlash(el);
                });
              }
            });
          });
        })();
      </script>
    {% endif %}

    {% block content %}{% endblock %}
  </div>
</body>
</html>